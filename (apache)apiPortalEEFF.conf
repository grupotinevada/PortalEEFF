<VirtualHost *:80>
    ServerName portaleeffapitest.inevada.cl

    # Habilitar el motor de reescritura para WebSockets
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteRule /(.*) ws://192.168.101.16:3003/$1 [P,L]

    # Configuración del proxy inverso para tráfico HTTP normal
    ProxyPass / http://192.168.101.16:3003/
    ProxyPassReverse / http://192.168.101.16:3003/

    # Preserva el encabezado Host original, equivalente a proxy_set_header Host $host;
    ProxyPreserveHost On

    # Establece los encabezados para la IP real y el protocolo
    RequestHeader set X-Real-IP "%{REMOTE_ADDR}s"
    RequestHeader set X-Forwarded-Proto "http"

</VirtualHost>